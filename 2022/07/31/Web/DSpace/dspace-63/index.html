<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"imagenature.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Preface 机构存储库软件叫法很多，但意思基本都是大学，研究机构等用来存储数字资产的工具，尽管有细微差别，然本文不做细致区分。 最近在整理笔记本时发现资料挺多，想找个软件进行管理，机缘巧合下就找到了 DSpace 这个开源机构存储库软件。">
<meta property="og:type" content="article">
<meta property="og:title" content="DSpace6.3 的安装和自定义过程记录">
<meta property="og:url" content="https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/index.html">
<meta property="og:site_name" content="不懂悲伤的魔法猫">
<meta property="og:description" content="Preface 机构存储库软件叫法很多，但意思基本都是大学，研究机构等用来存储数字资产的工具，尽管有细微差别，然本文不做细致区分。 最近在整理笔记本时发现资料挺多，想找个软件进行管理，机缘巧合下就找到了 DSpace 这个开源机构存储库软件。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-07-30T17:18:38.000Z">
<meta property="article:modified_time" content="2022-08-01T13:45:51.953Z">
<meta property="article:author" content="Image Nature">
<meta property="article:tag" content="dspace">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/","path":"2022/07/31/Web/DSpace/dspace-63/","title":"DSpace6.3 的安装和自定义过程记录"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>DSpace6.3 的安装和自定义过程记录 | 不懂悲伤的魔法猫</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="不懂悲伤的魔法猫" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">不懂悲伤的魔法猫</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">饮冰十年, 难凉热血</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/Statistics/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-中文"><a href="http://whoimage.com/" rel="noopener" target="_blank"><i class="fa fa-language fa-fw"></i>中文</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#preface"><span class="nav-number">1.</span> <span class="nav-text">Preface</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#something"><span class="nav-number">2.</span> <span class="nav-text">Something</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#requirements"><span class="nav-number">3.</span> <span class="nav-text">Requirements</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#step"><span class="nav-number">4.</span> <span class="nav-text">Step</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#system"><span class="nav-number">4.1.</span> <span class="nav-text">system</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#user"><span class="nav-number">4.1.1.</span> <span class="nav-text">user</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#net"><span class="nav-number">4.1.2.</span> <span class="nav-text">net</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#environment"><span class="nav-number">4.2.</span> <span class="nav-text">environment</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#update"><span class="nav-number">4.2.1.</span> <span class="nav-text">update</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#install-git"><span class="nav-number">4.2.2.</span> <span class="nav-text">install git</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#install-maven-and-ant"><span class="nav-number">4.2.3.</span> <span class="nav-text">install maven and ant</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#configure-maven"><span class="nav-number">4.2.4.</span> <span class="nav-text">configure maven</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#install-openjdk-8-jdk"><span class="nav-number">4.3.</span> <span class="nav-text">install openjdk-8-jdk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#install-postgresql"><span class="nav-number">4.4.</span> <span class="nav-text">install postgresql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#configure-postgresql"><span class="nav-number">4.5.</span> <span class="nav-text">configure postgresql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#install-tomcat"><span class="nav-number">4.6.</span> <span class="nav-text">install tomcat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E5%92%8C%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">4.7.</span> <span class="nav-text">创建用户和文件夹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD-dspace"><span class="nav-number">4.8.</span> <span class="nav-text">下载 dspace</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#configure-dspace"><span class="nav-number">4.9.</span> <span class="nav-text">configure dspace</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E6%9E%84%E5%BB%BA%E5%AE%89%E8%A3%85"><span class="nav-number">4.10.</span> <span class="nav-text">默认主题构建安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mirage-2-%E4%B8%BB%E9%A2%98%E6%9E%84%E5%BB%BA"><span class="nav-number">4.11.</span> <span class="nav-text">mirage 2 主题构建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82"><span class="nav-number">4.11.1.</span> <span class="nav-text">环境要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mirage2-%E4%B8%BB%E9%A2%98%E6%9E%84%E5%BB%BA%E5%AE%89%E8%A3%85"><span class="nav-number">4.11.2.</span> <span class="nav-text">mirage2 主题构建安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="nav-number">4.11.3.</span> <span class="nav-text">自定义</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B0%83%E8%89%B2"><span class="nav-number">4.11.3.1.</span> <span class="nav-text">调色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E5%85%83%E7%B4%A0"><span class="nav-number">4.11.3.2.</span> <span class="nav-text">通用元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D%E6%96%87%E5%AD%97"><span class="nav-number">4.11.3.3.</span> <span class="nav-text">介绍文字</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E8%84%9A%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="nav-number">4.11.3.4.</span> <span class="nav-text">页脚自定义</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B5%81%E7%A8%8B%E5%8F%82%E8%80%83"><span class="nav-number">4.11.4.</span> <span class="nav-text">自定义流程参考</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BF%80%E6%B4%BB%E4%B8%BB%E9%A2%98"><span class="nav-number">4.12.</span> <span class="nav-text">激活主题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-dspace-%E8%B4%A6%E5%8F%B7"><span class="nav-number">4.13.</span> <span class="nav-text">创建 dspace 账号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="nav-number">4.14.</span> <span class="nav-text">常用功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AA%92%E4%BD%93%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">4.14.1.</span> <span class="nav-text">媒体过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%89%88%E6%9C%AC%E5%8E%86%E5%8F%B2"><span class="nav-number">4.14.2.</span> <span class="nav-text">项目版本历史</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#configure-tomcat"><span class="nav-number">4.15.</span> <span class="nav-text">configure tomcat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nginx-%E4%BB%A3%E7%90%86"><span class="nav-number">4.16.</span> <span class="nav-text">Nginx 代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">4.17.</span> <span class="nav-text">常用命令</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Image Nature"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Image Nature</p>
  <div class="site-description" itemprop="description">我从来不曾优秀过，也从来不曾放弃过！</div>
</div>

         
​
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:imagenature#protonmail.com" title="E-Mail → mailto:imagenature#protonmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/ImageNature" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Image Nature">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不懂悲伤的魔法猫">
      <meta itemprop="description" content="我从来不曾优秀过，也从来不曾放弃过！">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="DSpace6.3 的安装和自定义过程记录 | 不懂悲伤的魔法猫">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DSpace6.3 的安装和自定义过程记录
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-31 01:18:38" itemprop="dateCreated datePublished" datetime="2022-07-31T01:18:38+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-08-01 21:45:51" itemprop="dateModified" datetime="2022-08-01T21:45:51+08:00">2022-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web/DSpace/" itemprop="url" rel="index"><span itemprop="name">DSpace</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>10 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="preface">Preface</h1>
<p>机构存储库软件叫法很多，但意思基本都是大学，研究机构等用来存储数字资产的工具，尽管有细微差别，然本文不做细致区分。</p>
<p>最近在整理笔记本时发现资料挺多，想找个软件进行管理，机缘巧合下就找到了
DSpace 这个开源机构存储库软件。</p>
<span id="more"></span>
<p>目前官网已经更新到了 7.3 版本。我也在本地安装了 DSpace7.2 和 7.3
两个版本，但看来看去最后还是选择了 DSpace6.3
这个版本。方便起见，DSpace6.3 以下简称为 dspace。</p>
<p>除了 DSpace
，还有其他很多机构存储库软件，但是默认界面，安装过程，使用模式等有较大区别,
选择凭个人喜好.
对个人来说可能搭建个网盘或者直接使用本地文件夹存储资料就足够了，并不需要这些东西.</p>
<h1 id="something">Something</h1>
<p>由于系统环境不一样，并且我是从新系统开始安装软件，因此以下内容会比较详细.</p>
<ul>
<li><p>发行版 debian-11.4.0-amd64-netinst</p>
<p>安装的时候尽量断网最小化安装，避免连接到国外的服务器下载安全更新等内容，这会导致安装进度过慢，同时作为服务器使用不需要桌面</p></li>
<li><p>内存选择 4G，这个看个人情况， 2G 也可以，再大的 8G，12G
也可以</p></li>
<li><p>2核心2处理器</p></li>
<li><p>硬盘，我选择 512 G，不够后期调整</p></li>
<li><p>xshell 进行ssh 连接</p></li>
<li><p>clash 魔法</p></li>
<li><p>由于软件的要求，用户命名为 dspace
，口令随意(生产环境不能随意)，我为了方便以下统一使用 password</p>
<p>如更改用户名等自行研究</p></li>
</ul>
<h1 id="requirements">Requirements</h1>
<ul>
<li><p>openjdk-8-jdk</p></li>
<li><p>git (必选，否则maven构建会出现问题)</p></li>
<li><p>postgresql</p></li>
<li><p>tomcat8 (tomcat9 尚不清楚是否存在兼容问题)</p></li>
<li><p>maven</p></li>
<li><p>ant</p></li>
<li><p>更多内容请见官网</p>
<p>https://dspace.lyrasis.org/</p></li>
</ul>
<h1 id="step">Step</h1>
<p>如无特殊说明，都在 dspace 用户下操作</p>
<h2 id="system">system</h2>
<h3 id="user">user</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小化安装新系统可能没有 openssh, sudo 等包</span></span><br><span class="line">su</span><br><span class="line">apt grade</span><br><span class="line">apt install openssh-server</span><br><span class="line">apt install sudo -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋予用户 sudo 权限</span></span><br><span class="line">sudo su - username</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换用户使用 sudo 可能会显示用户不在 sudo 文件里，因此需要添加</span></span><br><span class="line">su</span><br><span class="line">nano /etc/sudoers</span><br><span class="line"><span class="comment"># 在文件中找到 &lt;root ALL=(ALL) ALL&gt;，在该行下添加提升权限的用户信息，如：</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">username    ALL=(ALL)       ALL</span><br><span class="line"><span class="comment"># 这里的 username 为 dspace</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<h3 id="net">net</h3>
<p>换镜像源以及魔法上网可以避免很多麻烦，减少时间</p>
<ul>
<li><p><a
target="_blank" rel="noopener" href="https://www.cnblogs.com/liuguanglin/p/debian11_repo.html">Debian
11 (bullseye) 国内软件源</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://www.debian.org/mirror/list">Debian
全球镜像站</a></p></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份软件源列表</span></span><br><span class="line"><span class="built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line"><span class="comment"># 修改软件源列表</span></span><br><span class="line">sudo nano /etc/apt/sources.list</span><br><span class="line"><span class="comment"># 更新软件源列表</span></span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>以下为魔法常用命令, 注意仅当前终端有效:</p>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></table></figure></p>
<p>一个相关教程，后面我会自己整理一下，不同发行版的魔法都得照顾到</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.idcbuy.net/it/linux/2433.html">在 Linux
服务器上安装 Clash，以及开机自动启动</a></li>
</ul>
<h2 id="environment">environment</h2>
<h3 id="update">update</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure>
<h3 id="install-git">install git</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git</span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>
<h3 id="install-maven-and-ant">install maven and ant</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install maven</span><br><span class="line">sudo apt install ant</span><br></pre></td></tr></table></figure>
<h3 id="configure-maven">configure maven</h3>
<p>maven
在国内使用很慢，整个项目构建，可能会需要几十分钟到一两个小时，换源是一个比较好的选择，这里选择的是阿里云的镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/maven/settings.xml</span><br></pre></td></tr></table></figure>
<p>把两个 <code>&lt;mirrors&gt;</code> 中间的部分换成以下内容:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- aliyun mirrors--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- mirrors1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>repo1<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repo1.maven.org/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- mirrors2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>repo2<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repo2.maven.org/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="install-openjdk-8-jdk">install openjdk-8-jdk</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install openjdk-8-jdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果出现</span></span><br><span class="line"><span class="comment"># E: Unable to locate package openjdk-8-jdk</span></span><br><span class="line"><span class="comment"># 执行</span></span><br><span class="line">sudo add-apt-repository ppa:webupd8team/java</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果出现</span></span><br><span class="line"><span class="comment"># sudo: apt-add-repository: command not found</span></span><br><span class="line"><span class="comment"># 执行</span></span><br><span class="line">sudo apt-get install software-properties-common</span><br><span class="line"><span class="comment"># 添加 Debian stretch ppa.</span></span><br><span class="line">sudo apt-add-repository <span class="string">&#x27;deb http://security.debian.org/debian-security stretch/updates main&#x27;</span></span><br><span class="line"><span class="comment"># 更新软件包源并下载安装 openjdk-8-jdk</span></span><br><span class="line">sudo apt update &amp;&amp; sudo apt install openjdk-8-jdk</span><br><span class="line"></span><br><span class="line"><span class="comment">## 以上方案已经不行了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 新方案如下</span></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">sudo apt-get update &amp;&amp; sudo apt-get install -y apt-transport-https software-properties-common ca-certificates lsb-release wget dirmngr gnupg</span><br><span class="line"><span class="comment"># 添加 AdoptOpenJDK GPG root用户执行</span></span><br><span class="line">wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | apt-key add -</span><br><span class="line"><span class="comment"># 添加 AdoptOpenJDK 官方仓库，root用户执行</span></span><br><span class="line">add-apt-repository --<span class="built_in">yes</span> https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/</span><br><span class="line"><span class="comment"># 更新 root用户执行</span></span><br><span class="line">apt-get update</span><br><span class="line"><span class="comment"># 安装 OpenJDK 8 JDK root用户执行</span></span><br><span class="line">apt-get install adoptopenjdk-8-hotspot</span><br><span class="line"><span class="comment"># 如果需要安装 OpenJDK 8 JRE root用户执行</span></span><br><span class="line">apt-get install adoptopenjdk-8-hotspot-jre</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果之前安装了其他版本的 OpenJDK</span></span><br><span class="line"><span class="comment"># 将默认 java 更改为 OpenJDK 8</span></span><br><span class="line">sudo update-alternatives --config java </span><br><span class="line"><span class="comment"># 按要求操作即可</span></span><br></pre></td></tr></table></figure>
<h2 id="install-postgresql">install postgresql</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看可下载的 postgerspl版本 </span></span><br><span class="line">sudo apt-cache search postgresql</span><br><span class="line"><span class="comment"># 下载安装 postgerspl</span></span><br><span class="line">sudo apt install postgresql postgresql-client postgresql-contrib</span><br><span class="line"><span class="comment"># 注意版本号</span></span><br><span class="line">sudo pg_ctlcluster 13 main start	</span><br><span class="line"><span class="comment"># 查看活动状态</span></span><br><span class="line">sudo systemctl status postgresql</span><br></pre></td></tr></table></figure>
<h2 id="configure-postgresql">configure postgresql</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分组创建用户名为 postgres</span></span><br><span class="line"><span class="built_in">groups</span> postgres</span><br><span class="line"><span class="comment"># 给 postgres 用户(password)</span></span><br><span class="line">sudo passwd postgres</span><br><span class="line"><span class="comment"># 输入口令</span></span><br><span class="line">password</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换成 postgres 用户</span></span><br><span class="line">su postgres</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个dspace 数据库用户 (此用户可以有任何名称，但我假设命名为“dspace”), 如果自定义请自行研究：</span></span><br><span class="line">createuser --username=postgres --no-superuser --pwprompt dspace</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入口令</span></span><br><span class="line">password</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个由 PostgreSQL 用户 dspace 拥有的数据库</span></span><br><span class="line">createdb --username=postgres --owner=dspace --encoding=UNICODE dspace</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后，必须在新的 dspace 数据库上启用 pgcrypto 扩展</span></span><br><span class="line">psql --username=postgres dspace -c <span class="string">&quot;CREATE EXTENSION pgcrypto;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看配置，确保使用 utf-8 编码，最近的都是默认的</span></span><br><span class="line">psql -c <span class="string">&quot;SHOW SERVER_ENCODING&quot;</span></span><br><span class="line"><span class="comment"># 显示 UTF-8 说明已经使用</span></span><br><span class="line"><span class="comment"># 退出，回到原来的用户</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用 TCP</span></span><br><span class="line"><span class="comment"># 检查一下，尽管最近的版本都是默认的，也有可能没启用</span></span><br><span class="line"><span class="built_in">cd</span> /etc/postgresql/13/main/</span><br><span class="line"><span class="comment"># 不同版本不同，要查一下	</span></span><br><span class="line">sudo nano postgresql.conf</span><br><span class="line"><span class="comment"># 寻找以下内容</span></span><br><span class="line">listen_addresses = <span class="string">&#x27;localhost&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加安全性</span></span><br><span class="line">sudo nano pg_hba.conf</span><br><span class="line"><span class="comment"># 在ipv4 最后面添加</span></span><br><span class="line"><span class="built_in">local</span>  all  dspace  md5 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启 postgresql 并查看当前状态,</span></span><br><span class="line">sudo systemctl restart postgresql</span><br><span class="line">systemctl status postgresql</span><br></pre></td></tr></table></figure>
<h2 id="install-tomcat">install tomcat</h2>
<p>直接使用 <code>apt</code> 包管理器安装在使用的时候似乎有问题
(安装的版本是 tomcat9 )，点击发现栏跳转的页面显示乱码，本人不了解 tomcat
因此没有研究，也不清楚究竟是哪里出现的问题</p>
<p>以下使用另外一种安装方式 (这里安装的是 tomcat8 的最新版本,
其他版本请自行研究) :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在用户主目录下安装</span></span><br><span class="line"><span class="built_in">cd</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 官网下载安装，很慢</span></span><br><span class="line">sudo wget https://downloads.apache.org/tomcat/tomcat-8/v8.5.81/bin/apache-tomcat-8.5.81.tar.gz</span><br><span class="line"><span class="comment"># 国内可以使用阿里云的镜像</span></span><br><span class="line">sudo wget http://mirrors.aliyun.com/apache/tomcat/tomcat-8/v8.5.81/bin/apache-tomcat-8.5.81.tar.gz?spm=a2c6h.25603864.0.0.2ec3337cc0Tbi7</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压, 善用 tab 键补全</span></span><br><span class="line">sudo tar xzvf &lt;tomcat压缩包名&gt;</span><br><span class="line"><span class="comment"># 重命名</span></span><br><span class="line">sudo <span class="built_in">mv</span> &lt; tomcat文件名&gt; tomcat</span><br></pre></td></tr></table></figure>
<p>自定义启动可以通过设置脚本来实现</p>
<h2 id="创建用户和文件夹">创建用户和文件夹</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果之前没有创建就创建，如果已经创建就跳过</span></span><br><span class="line">sudo useradd -m dspace</span><br><span class="line">sudo password dspace</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 DSpace 文件夹并授予权限(这个步骤尽量不改。否则要改配置文件)</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> /dspace</span><br><span class="line">sudo <span class="built_in">chown</span> dspace /dspace </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 bulid 文件夹并授予权限</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> /build</span><br><span class="line">sudo <span class="built_in">chmod</span> -R 777 /build</span><br></pre></td></tr></table></figure>
<h2 id="下载-dspace">下载 dspace</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换目录</span></span><br><span class="line"><span class="built_in">cd</span> /build	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载 DSpace 6.3 from GitHub, 无法连接就 ftp 上传</span></span><br><span class="line">wget https://github.com/DSpace/DSpace/releases/download/dspace-6.3/dspace-6.3-src-release.tar.gz	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取 dspace*.tar.gz</span></span><br><span class="line">tar xzvf dspace*.tar.gz	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入文件夹 dspace-6.3-src-release</span></span><br><span class="line"><span class="built_in">cd</span> dspace-6.3-src-release</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制文件 local.cfg</span></span><br><span class="line"><span class="built_in">cp</span> dspace/config/local.cfg.EXAMPLE dspace/config/local.cfg</span><br></pre></td></tr></table></figure>
<h2 id="configure-dspace">configure dspace</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查阅 dspace/config 文件夹中的 local.cfg 文件</span></span><br><span class="line"><span class="built_in">cd</span> dspace/config</span><br><span class="line">sudo nano local.cfg</span><br><span class="line"><span class="comment"># 一定得确保 postgresql 数据库的密码跟之前设的一样</span></span><br><span class="line"><span class="comment"># 必须把(如果不是按照流程走，请自行研究,这里的目的是使得数据库用户和口令对应上)</span></span><br><span class="line">db.username = dspace</span><br><span class="line">db.password = dspace</span><br><span class="line"><span class="comment"># 改为之前创建的数据库用户和口令</span></span><br><span class="line">db.username = dspace</span><br><span class="line">db.password = password</span><br></pre></td></tr></table></figure>
<h2 id="默认主题构建安装">默认主题构建安装</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回目录 dspace-6.3-src-release</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">mvn -U package	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此时注意魔法有没有开启</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 DSpace</span></span><br><span class="line"><span class="built_in">cd</span> dspace/target/dspace-installer</span><br><span class="line">sudo ant fresh_install</span><br><span class="line"></span><br><span class="line">sudo <span class="built_in">cp</span> -r /dspace/webapps/* /home/dspace/tomcat/webapps*</span><br></pre></td></tr></table></figure>
<h2 id="mirage-2-主题构建">mirage 2 主题构建</h2>
<p><strong>使用默认主题可以直接跳过，无影响</strong>.
如果需要自定义主题等内容，可以先在这里修改配置文件,也可以之后再修改.
开启 mirage2
主题请先完成自定义的环境要求，因为这是我的记录内容，我先进行修改.</p>
<h3 id="环境要求">环境要求</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里的安装过程中需要格外注意网络，魔法或者新终端</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 curl 安装 rvm:</span></span><br><span class="line">curl -sSL https://get.rvm.io | bash -s stable</span><br><span class="line"><span class="comment"># 这里可能会遇到网络问题，导致下载失败，可以重新开启一个终端</span></span><br><span class="line"><span class="built_in">source</span> /home/dspace/.rvm/scripts/rvm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 ruby</span></span><br><span class="line">rvm install 3.1.2</span><br><span class="line">rvm use 3.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 nvm, node, bower, grunt, sass 和 compass</span></span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span><br><span class="line"><span class="comment"># 安装 node14 的最新版本</span></span><br><span class="line">nvm install 14</span><br><span class="line"><span class="comment"># 如果出现命令找不到的错误，打开一个新终端即可</span></span><br><span class="line"><span class="comment"># 使用 node14</span></span><br><span class="line">nvm <span class="built_in">alias</span> default 14</span><br><span class="line"></span><br><span class="line">npm install -g bower</span><br><span class="line">npm install -g grunt &amp;&amp; npm install -g grunt-cli</span><br><span class="line">gem install sass -v 3.3.14</span><br><span class="line">gem install compass -v 1.0.1 </span><br></pre></td></tr></table></figure>
<p>相关内容自官方邮件交流</p>
<p><a
target="_blank" rel="noopener" href="https://groups.google.com/g/dspace-tech/c/VwUu1pxmwsk/m/5U95pP_JGQAJ?utm_medium=email&amp;utm_source=footer">解决方案参考来源</a></p>
<blockquote>
<p>tant...@umn.edu</p>
<p>2022年5月12日 23:14:58</p>
<p>收件人 bla...@umich.edu、DSpace Technical Support</p>
<p>Thanks Jose!</p>
<p>I leveraged the instructions at <a
target="_blank" rel="noopener" href="https://github.com/DSpace/DSpace/tree/dspace-6_x/dspace-xmlui-mirage2#installation"
class="uri">https://github.com/DSpace/DSpace/tree/dspace-6_x/dspace-xmlui-mirage2#installation</a>
and a single user installation of rvm to finally get my build to work.
Here's what finally did it for me:</p>
<p>## grab rvm and install for the dspace user only:</p>
<p>curl -sSL <a target="_blank" rel="noopener" href="https://get.rvm.io/">https://get.rvm.io</a> | bash
-s stable source /home/dspace/.rvm/scripts/rvm</p>
<p>## install a newish version of ruby (I did need to install a couple
RHEL packages, for which I have sudo) rvm install 3.1.2 rvm use
3.1.2</p>
<p>## install nvm, node, bower, grunt, sass and compass curl -o- <a
target="_blank" rel="noopener" href="https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh"
class="uri">https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh</a>
| bash nvm install 12 nvm alias default 12 npm install -g bower npm
install -g grunt &amp;&amp; npm install -g grunt-cli</p>
<p>gem install sass -v 3.3.14 gem install compass -v 1.0.1 (compass
install actually upgrades sass to 3.4.25)</p>
<p>That's it, I was able to build successfully by setting
-Dmirage2.deps.included=false which I think is the default anyway.</p>
<p>~~Bill</p>
</blockquote>
<h3 id="mirage2-主题构建安装">mirage2 主题构建安装</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回目录 dspace-6.3-src-release</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意魔法有没有开启，魔法没开第一次可能会失败，因为经常切换终端，魔法仅本终端有效，如果下载还出现问题，就多切换终端</span></span><br><span class="line">mvn package -Dmirage2.on=<span class="literal">true</span> -Dmirage2.deps.included=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="built_in">cd</span> dspace/target/dspace-installer</span><br><span class="line">sudo ant fresh_install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把文件复制到 tomcat 中</span></span><br><span class="line">sudo <span class="built_in">cp</span> -r /dspace/webapps/* /home/dspace/tomcat/webapps*</span><br><span class="line">sudo service tomcat start </span><br></pre></td></tr></table></figure>
<h3 id="自定义">自定义</h3>
<p>参考内容来源</p>
<ul>
<li>https://wiki.lib.sun.ac.za/index.php/SUNScholar/XMLUI_Theme</li>
<li>https://github.com/twbs/bootstrap-sass/blob/6b0ca5025c64f2e5696c8719cfce7148c78d0a50/assets/stylesheets/bootstrap/_variables.scss</li>
</ul>
<h4 id="调色">调色</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /build/dspace-6.3-src-release/dspace-xmlui-mirage2/src/main/webapp/styles/classic_mirage_color_scheme/_bootstrap_variables.scss</span><br></pre></td></tr></table></figure>
<p>在文件底部添加内容即可, 我的配置文件如下:
(似乎面包屑的颜色设置不起作用)</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The contents of this file are subject to the license and copyright</span></span><br><span class="line"><span class="comment"> * detailed in the LICENSE and NOTICE files at the root of the source</span></span><br><span class="line"><span class="comment"> * tree and available online at</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * http://www.dspace.org/license/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// Preset Bootstrap variables</span></span><br><span class="line"><span class="comment">// ----------------------</span></span><br><span class="line"><span class="variable">$brand-primary</span>: <span class="number">#607890</span> !default;</span><br><span class="line"></span><br><span class="line"><span class="variable">$navbar-inverse-bg</span>: <span class="number">#1F3F5E</span> !default;</span><br><span class="line"><span class="variable">$navbar-inverse-link-color</span>: <span class="number">#eee</span> !default;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Colours CSS</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="variable">$navbar-inverse-bg</span>:      <span class="number">#000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$brand-primary</span>:          <span class="number">#bababa</span>;</span><br><span class="line"><span class="variable">$brand-warning</span>:          <span class="number">#ff9b33</span>;</span><br><span class="line"><span class="variable">$brand-success</span>:          <span class="number">#5cb85c</span>;</span><br><span class="line"><span class="variable">$brand-info</span>:             <span class="number">#5bc0de</span>;</span><br><span class="line"><span class="variable">$brand-danger</span>:           <span class="number">#d9534f</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$gray-base</span>:              <span class="number">#000</span>;</span><br><span class="line"><span class="variable">$gray-darker</span>:            <span class="number">#222</span>;</span><br><span class="line"><span class="variable">$gray-dark</span>:              <span class="number">#333</span>;</span><br><span class="line"><span class="variable">$gray</span>:                   <span class="number">#555</span>;</span><br><span class="line"><span class="variable">$gray-light</span>:             <span class="number">#777</span>;</span><br><span class="line"><span class="variable">$gray-lighter</span>:           <span class="number">#eee</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$link-color</span>:             <span class="number">#82bbf5</span>;</span><br><span class="line"><span class="comment">//** Link hover color set via `darken()` function.</span></span><br><span class="line"><span class="variable">$link-hover-color</span>:       <span class="number">#FF69B4</span>;</span><br><span class="line"><span class="comment">//** Link hover decoration.</span></span><br><span class="line"><span class="variable">$link-hover-decoration</span>: underline !default;</span><br><span class="line"></span><br><span class="line"><span class="variable">$component-active-bg</span>:           <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$btn-primary-bg</span>:                <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$pagination-active-bg</span>:          <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$pagination-active-border</span>:      <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$progress-bar-bg</span>:               <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$label-primary-bg</span>:              <span class="number">#000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$panel-primary-border</span>:          <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$panel-primary-heading-bg</span>:      <span class="number">#000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$table-bg-hover</span>:                <span class="number">#0fdb79</span>;</span><br><span class="line"><span class="variable">$list-group-hover-bg</span>:           <span class="number">#0fdb79</span>;</span><br><span class="line"><span class="variable">$dropdown-link-hover-bg</span>:        <span class="number">#0fdb79</span>;</span><br><span class="line"><span class="variable">$pagination-hover-bg</span>:           <span class="number">#0fdb79</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$breadcrumb-bg</span>:                 <span class="number">#000000</span>;</span><br><span class="line"><span class="variable">$breadcrumb-color</span>:              <span class="number">#c4a91d</span>;</span><br><span class="line"><span class="variable">$breadcrumb-active-color</span>:       <span class="number">#0fdb79</span>;</span><br><span class="line"><span class="variable">$breadcrumb-separator</span>:          <span class="string">&quot;&gt;&gt;&quot;</span> !default;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="通用元素">通用元素</h4>
<p>使用 <code>dspace.cfg</code> 文件完成配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo nano <span class="variable">$HOME</span>/source/dspace/config/dspace.cfg</span><br><span class="line">sudo nano /build/dspace-6.3-src-release/dspace/config</span><br></pre></td></tr></table></figure>
<p>主要修改以下内容:</p>
<p><strong>显示计数器</strong></p>
<p>搜索<code>webui.strengths.show</code>并更改为<code>true</code>。</p>
<p>Search for <code>webui.strengths.show</code> and change to
<code>true</code>.</p>
<p><strong>显示推荐</strong></p>
<p>搜索 <code>webui.suggest.enable</code>并更改为
<code>true</code>。</p>
<p>Search for <code>webui.suggest.enable</code> and change to
<code>true</code>.</p>
<p><strong>显示带有项目列表的文件缩略图</strong></p>
<p>搜索<code>xmlui.theme.mirage.item-list.emphasis</code>并取消注释，使重点变为“文件”而不是“元数据”，当然我并没有很理解这句话。</p>
<p>Search for <code>xmlui.theme.mirage.item-list.emphasis</code> and
uncomment by removing the hash character in front, so that the emphasis
becomes "file" not "metadata".</p>
<p><strong>从右侧导航框中删除“注册”链接</strong> 在 DSpace
配置文件中，设置以下内容并重新构建。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlui.user.registration=false</span><br></pre></td></tr></table></figure>
<h4 id="介绍文字">介绍文字</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano $HOME/source/dspace/config/news-xmlui.xml</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Use the following tags for content markup:</p>
<ul>
<li><head>
<p>Title etc..</p>
</head></li>
<li><p>
<p>.....</p>
</p>
<p>for paragraphs.</p></li>
<li><p><list>(add items, see below)</list></p></li>
<li><p><item>Item content</item>. Items in list above.</p></li>
<li><p><xref target="<http://wiki.lib.sun.ac.za/index.php/BOAI/Section3>">BOAI
Section 3</xref> for hyperlinks to other online content.</p></li>
<li><figure source="<http://www.dspace.org/sites/dspace.org/files/dspace_logo.png>
<p>"/&gt;</p></li>
<li><p><hi rend="bold">Bold text... </hi></p></li>
<li><p><hi rend="italic">Italic text... </hi></p></li>
</ul>
</blockquote>
<h4 id="页脚自定义">页脚自定义</h4>
<p>编辑下面这个文件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo nano $HOME/source/dspace-xmlui-mirage2/src/main/webapp/xsl/core/page-structure.xsl</span><br><span class="line">sudo nano /build/dspace-6.3-src-release/dspace-xmlui-mirage2/src/main/webapp/xsl/core/page-structure.xsl</span><br></pre></td></tr></table></figure>
<p><code>Ctrl</code> + <code>shift</code> + <code>-</code> 跳转到 700
行:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;http://www.dspace.org&quot;&gt;DSpace 5.3&lt;/a&gt; | &lt;a href=&quot;http://www.ubuntu.com&quot;&gt;Ubuntu 14.04&lt;/a&gt; | Copyright © &lt;a href=&quot;http://www.sun.ac.za&quot; target=&quot;_blank&quot;&gt;Stellenbosch University&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>根据自己的内容进行修改</p>
<h3 id="自定义流程参考">自定义流程参考</h3>
<p>由于我没有接触过相关依赖的使用方法，也懒得学了，因此不知道如何实时查看主题文件修改的结果。我当时是开三个终端，修改文件后切换终端执行相应的命令，由于已经在本地配置好环境，编译速度还可以接受，几分钟就可以看到结果.
如果自定义程度要求高建议自行学习</p>
<p>注意浏览器开启禁止缓存</p>
<p>常用命令如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一个终端负责修改文件</span></span><br><span class="line">sudo nano /build/dspace-6.3-src-release/dspace-xmlui-mirage2/src/main/webapp/styles/classic_mirage_color_scheme/_bootstrap_variables.scss</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二个终端切换到相应目录下负责编译</span></span><br><span class="line">mvn package -Dmirage2.on=<span class="literal">true</span> -Dmirage2.deps.included=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三个终端切换到相应目录下负责安装和负责</span></span><br><span class="line">sudo <span class="built_in">cp</span> -r /dspace/webapps/* /home/dspace/tomcat/webapps* &amp;&amp; sudo service tomcat start </span><br></pre></td></tr></table></figure>
<h2 id="激活主题">激活主题</h2>
<ul>
<li>打开文件:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano $HOME/source/dspace/config/xmlui.xconf</span><br></pre></td></tr></table></figure>
<ul>
<li>添加 "<themes>" 部分:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;theme name=&quot;Mirage 2&quot; regex=&quot;.*&quot; path=&quot;Mirage2/&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="创建-dspace-账号">创建 dspace 账号</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo /dspace/bin/dspace create-administrator</span><br><span class="line"></span><br><span class="line"><span class="comment"># 填写信息，注意 @ 这个符号一定要有，这里可以创建不带 @ 符号的账号， 但是在网页会进行检测，无法登录</span></span><br><span class="line">dspace@dspace.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># First name:</span></span><br><span class="line">Persional</span><br><span class="line"><span class="comment"># Last name:</span></span><br><span class="line">Repository</span><br><span class="line"><span class="comment"># 口令</span></span><br><span class="line">password</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除构建文件夹，建议不删</span></span><br><span class="line">sudo <span class="built_in">rm</span> -rf /build	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浏览器询问 DSpace</span></span><br><span class="line">http://localhost:8080/xmlui atau http://serverIP:8080/xmlui</span><br><span class="line">http://localhost:8080/jspui atau http://serverIP:8080/jspui	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 本机 ip 查询</span></span><br><span class="line">ip addr show</span><br></pre></td></tr></table></figure>
<h2 id="常用功能">常用功能</h2>
<h3 id="媒体过滤器">媒体过滤器</h3>
<p>为 PDF , 图片等生成缩略图，可以创建脚本作为定期任务执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /dspace/bin/dspace filter-media</span><br></pre></td></tr></table></figure>
<p>如果出现 <code>OutOfMemoryError</code> 的错误，则需要修改内容</p>
<p><a
target="_blank" rel="noopener" href="https://groups.google.com/g/dspace-community/c/aczy_rH977w">解决方案参考来源</a></p>
<blockquote>
<p>FILIPPOS KOLOVOS 2021年3月23日 00:16:59 收件人
pany...@gmail.com、DSpace Community Dear Sir,</p>
</blockquote>
<blockquote>
<p>This error relates to the Garbage Collection (GC) mechanism of JVM,
which means that it does not have enough memory available to complete
the task. More in particular, it means that the Garbage Collector is
spending too much time clearing the heap space from unused objects, but
at the same time it does not free more than 2% of the heap space, which
is used for the instantiated objects. That's wh the GC reports that it
does not have any more space to do its job.</p>
<p>One thing you can do, if you do not have enough RAM on your server,
is first shutdown Tomcat (this will lead to some downtime for your
server, but it will free up some valuable RAM and after OAI completes
you can restart it) and then go to the
<strong>/dspace/bin/dspace</strong> file of your running dspace instance
and edit it with your text editor. Then, in the file search and find the
line:</p>
<p><strong>JAVA_OPTS="-Xmx256m -Dfile.encoding=UTF-8"</strong></p>
<p>and <strong>change it</strong> to:</p>
<p><strong><a href="">JAVA_OPTS="-Xmx2048m -Xms1024m
-Dfile.encoding=UTF-8"</a></strong></p>
<p><strong>DO NOT</strong> copy and paste the line, but edit it in
place, because you do not want to mess up this file.</p>
<p>This will specify that the dspace <strong>TOOL</strong> (which is the
file you are running for the OAI) will use <strong>from 1024MB up to
2048MB RAM</strong> for its task and not just <strong>256MB</strong>.
However, you <strong>must have more than 2048MB RAM</strong> available
on the server (i.e. 3GB), or the script will fail again and it might
hang your server. If you have <strong>LESS</strong> than 3GB allocated
to the server, then adjust these values accordingly (i.e. Xmx1024m
Xms500m, etc).</p>
<p>The bottomline is that you do not have enough memory to complete the
task and even if your server has 32GB RAM, the dspace tool will only use
up to the RAM specified in this file.</p>
<p>I hope that I have helped!</p>
<p>Best Regards,</p>
<p>-Fk</p>
</blockquote>
<h3 id="项目版本历史">项目版本历史</h3>
<p>参见官网文档取消注释即可，对应配置文件与开启 mirage2
的配置文件是同一个.</p>
<p>配置文件有 item 字样，可以阅读相关注释确定，并不复杂</p>
<h2 id="configure-tomcat">configure tomcat</h2>
<p>不配置文本可以通过执行以下命令启动 tomcat,
相关命令可以与媒体过滤器一起执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /home/dspace/tomcat/bin/startup.sh</span><br></pre></td></tr></table></figure>
<h2 id="nginx-代理">Nginx 代理</h2>
<p>用得不熟悉，代理过程有 bug , 暂时不使用</p>
<p><strong>referen</strong></p>
<ul>
<li>http://tuckey.org/urlrewrite/</li>
<li>https://wiki.lib.sun.ac.za/index.php/SUNScholar/Prepare_Ubuntu/S05/Ubuntu-16.04</li>
</ul>
<h2 id="常用命令">常用命令</h2>
<p>启动 tomcat 并为 PDF 和图片生成缩略图</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /home/dspace/tomcat/bin/startup.sh &amp;&amp; sudo /dspace/bin/dspace filter-media</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Image Nature
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/" title="DSpace6.3 的安装和自定义过程记录">https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/dspace/" rel="tag"># dspace</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/07/13/Web/MediaWiki/install-MediaWiki/" rel="prev" title="Install MediaWiki in Debian">
                  <i class="fa fa-chevron-left"></i> Install MediaWiki in Debian
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Image Nature</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Symbols count total: </span>
    <span title="Symbols count total">21k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">19 mins.</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--添加运行时间-->
<span id="sitetime"></span>
<script language=javascript>
	function siteTime(){
		window.setTimeout("siteTime()", 1000);
		var seconds = 1000;
		var minutes = seconds * 60;
		var hours = minutes * 60;
		var days = hours * 24;
		var years = days * 365;
		var today = new Date();
		var todayYear = today.getFullYear();
		var todayMonth = today.getMonth()+1;
		var todayDate = today.getDate();
		var todayHour = today.getHours();
		var todayMinute = today.getMinutes();
		var todaySecond = today.getSeconds();
		/* 
      Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数
     */
		var t1 = Date.UTC(2022,07,12,04,12,20); //北京时间2018-2-13 00:00:00
		var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
		var diff = t2-t1;
		var diffYears = Math.floor(diff/years);
		var diffDays = Math.floor((diff/days)-diffYears*365);
		var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
		var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
		var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
		document.getElementById("sitetime").innerHTML=" Already run "+/*diffYears+" year "+*/diffDays+" day "+diffHours+" hour "+diffMinutes+" mimuter "+diffSeconds+" second";
	}
	siteTime();
</script>
<!--// 添加运行时间-->
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>


    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>


  <script src="/js/third-party/fancybox.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.2.0/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":false,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://imagenature.github.io/2022/07/31/Web/DSpace/dspace-63/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
